---

copyright:
  years: 2017, 2018, 2019
lastupdated: "2019-03-21"

keywords: ip address, firewall, configuration, api

subcollection: cloud-object-storage

---
{:new_window: target="_blank"}
{:shortdesc: .shortdesc}
{:codeblock: .codeblock}
{:pre: .pre}
{:screen: .screen}
{:tip: .tip}
{:important: .important}
{:note: .note}
{:download: .download} 

# ファイアウォールの設定
{: #setting-a-firewall}

IAM ポリシーは、管理者が個々のバケットへのアクセスを制限する方法を提供します。特定のデータには信頼できるネットワークからのみアクセスする必要がある場合はどうすればよいでしょうか。バケット・ファイアウォールは、許可される IP アドレスのリストから発信された要求でない限り、データへのすべてのアクセスを制限します。
{: shortdesc}

ファイアウォールの設定には、以下の規則があります。

* ファイアウォールを設定または表示するユーザーは、バケットに対する「`管理者`」役割を持っている必要があります。 
* バケットに対する「`管理者`」役割を持っているユーザーは、偶発的なロックアウトを防止するため、任意の IP アドレスから、許可される IP アドレスのリストを表示および編集できます。
* ユーザーの IP アドレスが許可されていれば、{{site.data.keyword.cos_short}} コンソールはまだバケットにアクセスできます。
* その他の {{site.data.keyword.cloud_notm}} サービスは、ファイアウォールを迂回することを**許可されません**。この制限は、バケットのアクセスに関する IAM ポリシーに依存するその他のサービス (Aspera、SQL Query、Security Advisor、Watson Studio、Cloud Functions など) がそれを行えないことを意味します。

ファイアウォールが設定されると、バケットは {{site.data.keyword.cloud_notm}} の残りの部分から隔離されます。バケットに直接アクセスする他のサービスに依存するアプリケーションおよびワークフローにこれが与える影響を検討した後で、ファイアウォールを有効にしてください。
{: important}

## コンソールを使用したファイアウォールの設定
{: #firewall-console}

最初に、バケットがあることを確認します。ない場合は、[入門チュートリアル](/docs/services/cloud-object-storage?topic=cloud-object-storage-getting-started)の手順に従って、コンソールについて理解してください。

### 許可される IP アドレスのリストの設定
{: #firewall-console-enable}

1. {{site.data.keyword.cloud_notm}} [コンソール・ダッシュボード](https://cloud.ibm.com/)から、**「ストレージ」**を選択してリソース・リストを表示します。
2. 次に、**「ストレージ」**メニュー内から、バケットがあるサービス・インスタンスを選択します。これによって {{site.data.keyword.cos_short}} コンソールが表示されます。
3. 許可される IP アドレスにアクセスを限定する対象のバケットを選択します。 
4. ナビゲーション・メニューから**「アクセス・ポリシー」**を選択します。
5. **「許可される IP」**タブを選択します。
6. **「IP アドレスの追加」**をクリックし、**「追加」**を選択します。
7. IP アドレスのリストを [CIDR 表記](https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing)で追加します。例えば、`192.168.0.0/16, fe80:021b::0/64` です。IPv4 標準または IPv6 標準のいずれかに従うアドレスを使用できます。**「追加」**をクリックします。
8. ファイアウォールは、アドレスがコンソールに保存されるまでは適用されません。ファイアウォールを適用するには、**「すべて保存」**をクリックします。
9. これで、このバケット内のすべてのオブジェクトは、これらの IP アドレスからのみアクセス可能になります。

### IP アドレス制限の削除
{: #firewalls-console-disable}

1. **「許可される IP」**タブで、許可リストから削除する IP アドレスまたは範囲の横にあるボックスにチェック・マークを付けます。
2. **「削除」**を選択し、次に、もう一度**「削除」**をクリックしてダイアログ・ボックスを確認します。
3. 更新されたリストは、変更がコンソールに保存されるまで適用されません。新しいルールを適用するには、**「すべて保存」**をクリックします。
4. これで、このバケット内のすべてのオブジェクトは、これらの IP アドレスからのみアクセス可能になります。

許可される IP アドレスがリストされていない場合、ユーザーの IP アドレスには何も制限なく、通常の IAM ポリシーがバケットに適用されます。
{: note}


## API を使用したファイアウォールの設定
{: #firewall-api}

ファイアウォールは、[COS Resource Configuration API](https://cloud.ibm.com/apidocs/cos/cos-configuration) を使用して管理されます。この新しい REST API はバケットを構成するために使用されます。 

「`管理者`」役割を持っているユーザーは、偶発的なロックアウトを防止するため、任意のネットワークから、許可される IP アドレスのリストを表示および編集できます。
{: tip}
